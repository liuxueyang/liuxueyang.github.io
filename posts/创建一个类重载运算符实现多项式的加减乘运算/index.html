<!doctype html>

<html lang="zh-cn">

<head>
  <title>LXY Site</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="The HTML5 Herald" />
  <meta name="author" content="" />
  <meta name="generator" content="Hugo 0.32.2" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  <link rel="stylesheet" type="text/css" href="/css/styles.css" />
</head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="/">LXY Site</a>
            </h1>

      <ul id="social-media">
             
      </ul>
      
    </header>

    
<nav>
    <ul>
        
    </ul>
</nav>

    <main>




<article>

    <h1>创建一个类，重载运算符实现多项式的加，减，乘运算</h1>

    
        <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2012-12-14T08:44:00Z">Dec 14, 2012</time>
        </li>
        
        

        

        <li>4 min read</li>
    </ul>
</aside>
    

    <p>唉，我太弱了，这么个简单的东西，还是用数组写的，却因为各种错误，弄了一个晚上，C++还得好好学啊，各种语法，要弄清楚。</p>

<pre><code class="language-cpp">
#include &lt;iostream&gt;
#include &lt;cstdlib&gt;
#include &lt;cstdio&gt;
#include &lt;iomanip&gt;
#include &lt;cstring&gt;

using namespace std;

class Polynomial
{
public:
    Polynomial(int  = 0);
    friend istream &amp; operator &gt;&gt; (istream &amp; input, Polynomial &amp; pl);
    friend ostream &amp; operator &lt;&lt; (ostream &amp; output, Polynomial &amp; pl);
    Polynomial &amp; operator += (Polynomial &amp; add);
    Polynomial &amp; operator -= (Polynomial &amp; add);
    Polynomial &amp; operator - (Polynomial &amp; add);
    Polynomial &amp; operator * (Polynomial &amp;);
    Polynomial &amp; operator + (Polynomial &amp; add);
    Polynomial &amp; operator *= (Polynomial &amp;);
    Polynomial &amp; operator = (Polynomial &amp; right);
    Polynomial &amp; test(Polynomial &amp; right);
private:
    int *a;
    int size, num;
};

Polynomial &amp; Polynomial::operator *= (Polynomial &amp; mu)
{
    Polynomial b, c;
    c = *this; b = *this;
    for (int j=0,r=0; j&lt;b.num;++j,r+=2)
    {
        (*this).a[r]+=mu.a[0]; (*this).a[r+1]*=mu.a[1];
    }
    for (int i=1,k=2;i&lt;mu.num;++i,k+=2)
    {
        for (int j=0,r=0; j&lt;b.num;++j,r+=2)
        {
            b.a[r]+=mu.a[k];
            b.a[r+1]*=mu.a[k+1];
        }
        *this += b;
        b = c;
    }
    return *this;
}
Polynomial &amp; Polynomial::operator * (Polynomial &amp; mu)
{
    Polynomial b, c;
    c = *this; b = *this;
    for (int j=0,r=0; j&lt;b.num;++j,r+=2)
    {
        (*this).a[r]+=mu.a[0]; (*this).a[r+1]*=mu.a[1];
    }
    for (int i=1,k=2;i&lt;mu.num;++i,k+=2)
    {
        for (int j=0,r=0; j&lt;b.num;++j,r+=2)
        {
            b.a[r]+=mu.a[k];
            b.a[r+1]*=mu.a[k+1];
        }
        *this += b;
        b = c;
    }
    return *this;
}

Polynomial &amp; Polynomial::operator = (Polynomial &amp; right)
{
    if (&amp;right != this)
    {
        delete [] a;
        size = right.size;
        num = right.num;
        a = new int[size];
        for (int i = 0; i &lt; size; ++i)
            a[i]=right.a[i];
    }
    else
        cout&lt;&lt;&quot;Attempted assignment of a polynomial to itself&quot; &lt;&lt; endl;
    return *this;
}

Polynomial &amp; Polynomial::operator -= (Polynomial &amp; add)
{
    int number = add.num, mrk = 0;
    int cosize = add.size; int * q = new int[cosize];
    for (int d=0;d&lt;cosize;++d) q[d]=add.a[d];
    for (int i = 0, s = 0; i &lt; number; ++i, s+=2)
    {
        mrk = 0;
        for (int j = 0, k = 0; j &lt; num; ++j,k+=2)
        {
            if (q[s]==a[k])
            {
                mrk = 1;
                a[k+1]-=q[s+1];
                q[s+1]=0;
            }
        }
        if (!mrk)
        {
            int *p = new int[size+2];
            for (int d=0;d&lt;size;d++)
                p[d]=a[d];
            p[size] = q[s];
            p[size+1] = -q[s+1];
            q[s+1]=0;
            a = p;
            num++;
            size+=2;
        }
    }
    return *this;
}
Polynomial &amp; Polynomial::operator - (Polynomial &amp; add)
{
    int number = add.num, mrk = 0;
    int cosize = add.size; int * q = new int[cosize];
    for (int d=0;d&lt;cosize;++d) q[d]=add.a[d];
    for (int i = 0, s = 0; i &lt; number; ++i, s+=2)
    {
        mrk = 0;
        for (int j = 0, k = 0; j &lt; num; ++j,k+=2)
        {
            if (q[s]==a[k])
            {
                mrk = 1;
                a[k+1]-=q[s+1];
                q[s+1]=0;
            }
        }
        if (!mrk)
        {
            int *p = new int[size+2];
            for (int d=0;d&lt;size;d++)
                p[d]=a[d];
            p[size] = q[s];
            p[size+1] = -q[s+1];
            q[s+1]=0;
            a = p;
            num++;
            size+=2;
        }
    }
    return *this;
}

Polynomial &amp; Polynomial::operator += (Polynomial &amp; add)
{
    int number = add.num, mrk = 0;
    int cosize = add.size; int * q = new int[cosize];
    for (int d=0;d&lt;cosize;++d) q[d]=add.a[d];
    for (int i = 0, s = 0; i &lt; number; ++i, s+=2)
    {
        mrk = 0;
        for (int j = 0, k = 0; j &lt; num; ++j,k+=2)
        {
            if (q[s]==a[k])
            {
                mrk = 1;
                a[k+1]+=q[s+1];
                q[s+1]=0;
            }
        }
        if (!mrk)
        {
            int *p = new int[size+2];
            for (int d=0;d&lt;size;d++)
                p[d]=a[d];
            p[size] = q[s];
            p[size+1] = q[s+1];
            q[s+1]=0;
            a = p;
            num++;
            size+=2;
        }
    }
    return *this;
}

Polynomial &amp; Polynomial::operator + (Polynomial &amp; add)
{
    int number = add.num, mrk = 0;
    Polynomial &amp; mi = *this;
    int cosize = add.size; int * q = new int[cosize];
    for (int d=0;d&lt;cosize;++d) q[d]=add.a[d];
    for (int i = 0, s = 0; i &lt; number; ++i, s+=2)
    {
        mrk = 0;
        for (int j = 0, k = 0; j &lt; mi.num; ++j,k+=2)
        {
            if (q[s]==mi.a[k])
            {
                mrk = 1;
                mi.a[k+1]+=q[s+1];
                q[s+1]=0;
            }
        }
        if (!mrk)
        {
            int *p = new int[mi.size+2];
            for (int d=0;d&lt;mi.size;d++)
                p[d]=mi.a[d];
            p[mi.size] = q[s];
            p[mi.size+1] = q[s+1];
            q[s+1]=0;
            mi.a = p;
            mi.num++;
            mi.size+=2;
        }
    }
    return mi;
}

ostream &amp; operator &lt;&lt; (ostream &amp; output, Polynomial &amp; pl)
{
    for (int i = 0, j = 0; i &lt; pl.num; ++i)
    {
        if (pl.a[j+1]==0)
        {
            output &lt;&lt; &quot;0 0 &quot;; j+=2; continue; 
        }
        output &lt;&lt; pl.a[j+1] &lt;&lt; &quot; &quot; &lt;&lt; pl.a[j] &lt;&lt; &quot; &quot;;
        j+=2;
    }
    output &lt;&lt; endl;
    return output;
}

istream &amp; operator &gt;&gt; (istream &amp; input, Polynomial &amp; pl)
{
    cout &lt;&lt; &quot;input the number of Polynomial terms: &quot;;
    input &gt;&gt; pl.num;
    pl.size = pl.num * 2;
    pl.a = new int[pl.size];
    int s, t;
    for (int i = 0, j = 0; i &lt; pl.num;)
    {
        input &gt;&gt; s &gt;&gt; t; 
        pl.a[j] = t; pl.a[j+1] = s;
        i++; j+=2;
    }
    return input;
}

Polynomial::Polynomial(int n)
    :num(n)
{
    size = num * 2;
    a = new int[size];
}

int main(void)
{
    Polynomial poly1, poly2, poly;
    freopen(&quot;in&quot;, &quot;r&quot;, stdin);

    cin &gt;&gt; poly1;
    cout &lt;&lt; endl;
    cin &gt;&gt; poly2;
    cout &lt;&lt; endl; 

/*    poly = poly1 + poly2;
    cout &lt;&lt; poly;

    poly1 -= poly2;
    poly = poly1;
    cout &lt;&lt; poly;
*/
    poly = poly1 * poly2;
    cout &lt;&lt; poly;

    return 0;
}

</code></pre>

<p>　　这个程序写得不好，重载运算符+，-，<em>和+=，-=，</em>=的代码是一样的，以后再改一下。而且很多地方，效率很低，很繁琐。
　　总结一下：因为在一个成员函数里面重复定义了一个变量，导致怎么也不对。最后没办法，现学gdb调试了，唉，这才发现错误，以后写代码的时候要过脑子，别想怎么写就怎么写，想想为什么这么写，认真一点儿，就会节约很多时间！当程序出现错误的时候，你的信念不应该是：我的程序是对的啊，怎么看怎么对。而应该是这样的：我的程序肯定在某个地方出错了，然后一行一行地检查。这样才会尽快找出错误。</p>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="http://liuxueyang.github.io/posts/hanoi/"><i class="fa fa-chevron-circle-left"></i> Hanoi</a>
        </li>
        
        
        <li>
            <a href="http://liuxueyang.github.io/posts/%E9%87%8D%E8%BD%BD%E8%BF%90%E7%AE%97%E7%AC%A6--%E5%AE%9E%E7%8E%B0%E5%AF%BB%E6%89%BE%E6%95%B0%E7%BB%84%E7%9A%84%E7%AC%ACk%E5%A4%A7%E7%9A%84%E5%85%83%E7%B4%A0/">重载运算符 [] 实现寻找数组的第K大的元素 <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
    





</main>
    <footer>
        <h6> | 
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="http://liuxueyang.github.ioindex.xml">Subscribe</a></h6>
    </footer>
</div>
<script src="/js/scripts.js"></script>
</body>

</html>