<!doctype html>

<html lang="zh-cn">

<head>
  <title>LXY Site</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="The HTML5 Herald" />
  <meta name="author" content="" />
  <meta name="generator" content="Hugo 0.32.2" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  <link rel="stylesheet" type="text/css" href="/css/styles.css" />
</head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="/">LXY Site</a>
            </h1>

      <ul id="social-media">
             
      </ul>
      
    </header>

    
<nav>
    <ul>
        
    </ul>
</nav>

    <main>




<article>

    <h1>实验七——王爽…………我写的最长的一个汇编程序==</h1>

    
        <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2013-10-06T00:20:00Z">Oct 6, 2013</time>
        </li>
        
        

        
        <li>
            <em>
                
                    
                    <a href="/tags/masm/">#masm</a>
                
            </em>
        </li>
        

        <li>2 min read</li>
    </ul>
</aside>
    

    <p>这是我到目前为止写的最长的汇编程序了。</p>

<pre><code>assume cs:sad, ds:data, ss:stack

stack segment
stack ends

data segment
    db '1975', '1976', '1977', '1978', '1979', '1980', '1981', '1982', '1983'
    db '1984', '1985', '1986', '1987', '1988', '1989', '1990', '1991', '1992'
  db '1993', '1994', '1995'
    ; 21 years -- 54h bytes

    dd 16, 22, 382, 1356, 2390, 8000, 16000, 24486, 50065, 97479, 140417, 197514
    dd 345980, 590827, 803530, 1183000, 1843000, 2759000, 3753000, 4649000, 5937000
    ; income in 21 years -- 54h bytes

    dw 3, 7, 9, 13, 28, 38, 130, 220, 476, 778, 1001, 1442, 2258, 2793, 4037, 5635, 8226
    dw 11542, 14430, 15257, 17800
    ; staff in 21 years -- 2ah bytes
data ends

table segment
    db 21 dup ('year summ ne ?? ')
table ends

sad segment
start:
    mov ax, table
    mov ds, ax
    mov ax, data
    mov es, ax
    mov di, 0
    mov bx, 0
    mov cx, 21
    mov si, 0
s:
    ; year
    mov ax, es:[di+0]
    mov ds:[bx+0], ax
    mov ax, es:[di+2]
    mov ds:[bx+2], ax

    mov ds:[bx+4], ' '
    
    ; income
    mov ax, es:[di+54h]
    mov ds:[bx+5], ax
    mov ax, es:[di+54h+2]
    mov ds:[bx+7], ax

    mov ds:[bx+9], ' '

    ; staff
    mov ax, es:[si+54h+54h]
    mov ds:[bx+0ah], ax

    mov ds:[bx+0ch], ' '

    ; average income
    mov ax, ds:[bx+5]
    mov dx, ds:[bx+7]
    div word ptr ds:[bx+0ah]
    mov ds:[bx+0dh], ax

    mov ds:[bx+0fh], ' '

    add di, 4
    ; the number of staff takes 2 bytes instead of 4!
    add si, 2
    add bx, 10h
    loop s

    mov ax, 4c00h
    int 21h
sad ends
end start
</code></pre>

<p>刚开始的错误是：没有注意到其实人数所占的字节是2个，步长设置成了4个，所以导致了做除法运算的时候出现了溢出。</p>

<p>程序运行对的那一刻，兴奋！</p>

<p>其实也不太难=_=</p>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="http://liuxueyang.github.io/posts/bx-bp-si-di%E5%AF%84%E5%AD%98%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8%E8%A7%84%E5%88%99/"><i class="fa fa-chevron-circle-left"></i> bx, bp, si, di寄存器的使用规则</a>
        </li>
        
        
        <li>
            <a href="http://liuxueyang.github.io/posts/%E4%B8%80%E4%B8%AA%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E6%B1%87%E7%BC%96%E7%A8%8B%E5%BA%8F-%E5%85%B6%E5%AE%9E%E5%B0%B1%E6%98%AF%E4%B8%80%E4%B8%AA%E6%A0%B9%E6%8D%AE%E4%BD%8D%E7%A7%BB%E8%BF%9B%E8%A1%8C%E8%BD%AC%E7%A7%BB%E7%9A%84%E5%BA%94%E7%94%A8/">一个有意思的汇编程序 ——其实就是一个根据位移进行转移的应用=_= <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
    





</main>
    <footer>
        <h6> | 
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="http://liuxueyang.github.ioindex.xml">Subscribe</a></h6>
    </footer>
</div>
<script src="/js/scripts.js"></script>
</body>

</html>